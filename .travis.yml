# The project language
os: linux
dist: bionic
language: c

jobs:
  include:
    - name: "Bindings: Java"
      compiler: gcc
      addons:
        apt:
          packages:
            - default-jdk junit4 default-jdk-doc
      script:
        - cd rhash
        - ./configure
        - make lib-shared test-lib print-info || ! cat config.mak librhash/config.mak config.log
        - javac --version && javadoc --version
        - make -C bindings build-java LIBRHASH_INC=-I$(pwd)/librhash LIBRHASH_LD=-L$(pwd)/librhash
        - LD_LIBRARY_PATH=$(pwd)/librhash make -C bindings test-java
        - make -C bindings clean-java

    - name: "Bindings: Mono"
      compiler: gcc
      addons:
        apt:
          packages:
            - cli-common-dev mono-devel monodoc-base
      script:
        - cd rhash
        - ./configure
        - make lib-shared test-lib print-info || ! cat config.mak librhash/config.mak config.log
        - mcs --version && mono --version
        - make -C bindings build-mono
        - LD_LIBRARY_PATH=$(pwd)/librhash make -C bindings test-mono
        - make -C bindings clean-mono

    - name: "Bindings: Perl"
      compiler: gcc
      script:
        - cd rhash
        - ./configure
        - make lib-shared test-lib print-info || ! cat config.mak librhash/config.mak config.log
        - perl --version
        - make -C bindings clean-perl configure-perl build-perl test-perl
        - make -C bindings clean-perl && make clean
        - make -C bindings cpan && tar xzf bindings/Crypt-RHash-[0-9]*.tar.gz
        - cd Crypt-RHash-[0-9]*/ && perl Makefile.PL && make all test

    - name: "Bindings: PHP"
      compiler: gcc
      addons:
        apt:
          packages:
            - php-dev
      script:
        - cd rhash
        - ./configure
        - make lib-shared test-lib print-info || ! cat config.mak librhash/config.mak config.log
        - php --version
        - make -C bindings configure-php build-php test-php
        - make -C bindings clean-php

    - name: "Bindings: Python 2 & 3"
      script:
        - cd rhash
        - ./configure
        - make lib-shared test-lib print-info || ! cat config.mak librhash/config.mak config.log
        - python2 --version && python3 --version
        - PYTHON=python2 LD_LIBRARY_PATH=$(pwd)/librhash make -C bindings test-python
        - PYTHON=python3 LD_LIBRARY_PATH=$(pwd)/librhash make -C bindings test-python
        - make -C bindings clean-python

    - name: "Bindings: Ruby"
      compiler: gcc
      env:
        - LIBRHASH_INC=-I$(pwd)/rhash/librhash
        - LIBRHASH_LD=-L$(pwd)/rhash/librhash
      addons:
        apt:
          packages:
            - ruby ruby-dev
      script:
        - cd rhash
        - ./configure
        - make lib-shared test-lib print-info || ! cat config.mak librhash/config.mak config.log
        - ruby --version
        - LD_LIBRARY_PATH=$(pwd)/librhash make -C bindings configure-ruby build-ruby test-ruby
        - make -C bindings clean-ruby
